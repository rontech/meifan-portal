@( styleAddForm: Form[Style], stylePara : models.StylePara, style: Style,bool: Boolean)

@import helper._
	
	<head>
		<script src="@routes.Assets.at("javascripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
		<script src="@routes.Assets.at("javascripts/ajaxfileupload.js")" type="text/javascript"></script>
<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/user/user.css")">
<script type="text/javascript">
function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            $('#target').append('<img src='+e.target.result+' style="float:left;width:156px;height:205px;margin-left:30px;margin-top:40px;"'+'>');
        }
        reader.readAsDataURL(input.files[0]);
    }
}

	$("#filePhoto").change(function() {
	    readURL(this);
	});

	$('.removeOptContactMethod').live('click', function(e) {
	    $(this).parents('.optContactMethod').remove()
	    renumber()
	})
	
	$('.addOptContactMethod').live('click', function(e) {
	    var template = $('.optContactMethod_template')
	    template.before('<div class="twipsies well optContactMethod">' + template.html() + '</div>')
	    renumber()
	})
	
	var renumber = function(accounts) {
	    $('.optContactMethod').each(function(i) {
	        $('input', this).each(function() {
	            $(this).attr('name', $(this).attr('name').replace(/stylePic\[.+?\]/g, 'stylePic[' + i + ']'))
	        })
	        $('.account input', this).each(function(i) {
	            $(this).attr('name', $(this).attr('name').replace(/accounts\[.+\]/g, 'accounts[' + i + ']'))
	        })
	    })
	}

	function ajaxFileUpload() {
	    $("#loading").ajaxStart(function() {
	        $(this).show();
	    }) @*开始上传文件时显示一个图片 *@ 
	           
		.ajaxComplete(function(){ 
	    	$(this).hide();
	     });
	     alert("action upload");                   
		$.ajaxFileUpload({                  
		url:"/fileUploadAction",                
		secureuri:false,                  
		fileElementId:'file',
		dataType:'text/html',
		success: function (data, status){ 
		
		alert("callback message" + data);
		 var reg = /<pre.+?>(.+)<\/pre>/g;  
        var result = data.match(reg); 
		
		alert(RegExp.$1);
		var objvalue=RegExp.$1;
		var $obj=$('.imageoffileobjid');
		var sizes=$obj.size();
		alert(sizes);
		if(sizes==2){
		alert('11111111111');
		var value1=$obj.eq(1).val(objvalue);
		alert(value);
		$obj.eq(1).val(objvalue);
		
		}else{
			var value2=$obj.eq(size-2).val(objvalue);
			alert("2222"+value2);
		}
		
		
		alert("obj.value"+$obj.val());
		alert("szies"+sizes);
		var arr1=$obj.get(0);
		alert("arr1"+arr1.value);
		
		alert("getvalue"+getvalue);
		                    
		
		alert("objId "+objId);
		if(typeof(data.error) != 'undefined'){
			if(data.error != ''){   
				alert(data.error);                
			}else{
				alert(data.message);    
			}           
		}                 
		},
		error: function (data, status, e){
			alert("files error"); 
			alert(e);  
		}             
		})                   
		return false;      
	}    

</script>
	</head>
	<body>
	@form(routes.Stylists.styleToAddNewStyle(if(style == null){new ObjectId}else{style.id}), 'enctype -> "multipart/form-data", 'id -> "styleAddForms"){
		@if(bool){
			<div>
				@Messages("hair.styleName")<input type = "text" class="" name = "styleName" value = "@style.styleName">
			</div>
			<div>
				@*@input(field = styleAddForm("stylePic"),args = '_label ->"图片"){(id,name,value,args) =>*@
	                <input type = "text" class="" name = "fileObjId" field = styleAddForm("stylePic.fileObjId") value = "">
	                <input type = "text" class="" name = "picUse" field = styleAddForm("stylePic.picUse") value = "sshit">
	                <input type = "number" class="" name = "showPriority" field = styleAddForm("stylePic.showPriority")value = "1">
	                <input type = "text" class="" name = "description" field = styleAddForm("stylePic.description")value = "">
				@*}*@
			</div>
			<div>
				@Messages("hair.stylist")<input type = "text" class="" name = "stylistId" field = styleAddForm("stylistId") value = "@style.stylistId">	
			</div>
		<div align="left">	
			<br/>@Messages("hair.styleLength")<br/>
	            @for(i <- 0 to stylePara.styleLength.length-1){
	                @if(style.styleLength.equals(stylePara.styleLength(i))){
	                    <input type = "radio" class="" name = "styleLength", value = "@stylePara.styleLength(i)" checked="checked">@stylePara.styleLength(i)
	                }else{
	                    <input type = "radio" class="" name = "styleLength", value = "@stylePara.styleLength(i)">@stylePara.styleLength(i)
	                }
	            }
	        <br/>@Messages("hair.impression")<br/>
	            @for(i <- 0 to stylePara.styleImpression.length-1){
	                @if(style.styleImpression.equals(stylePara.styleImpression(i))){
	                    <input type = "radio" class="" name = "styleImpression", value = "@stylePara.styleImpression(i)" checked="checked">@stylePara.styleImpression(i)
	                }else{
	                    <input type = "radio" class="" name = "styleImpression", value = "@stylePara.styleImpression(i)">@stylePara.styleImpression(i)
	                }
	            }
		    @input(field = styleAddForm("styleColor"),args = '_label ->Messages("hair.color")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.styleColor.length-1){
		    		@if(style.styleColor.contains(stylePara.styleColor(i))){
		      			<input type = "checkbox" class="" name = "styleColor[@i]", value = "@stylePara.styleColor(i)" checked="checked">@stylePara.styleColor(i)
		    		}else{
						<input type = "checkbox" class="" name = "styleColor[@i]", value = "@stylePara.styleColor(i)">@stylePara.styleColor(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("serviceType"),args = '_label ->Messages("hair.serviceType")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.serviceType.length-1){
		      		@if(style.serviceType.contains(stylePara.serviceType(i))){
		      			<input type = "checkbox" class="" name = "serviceType[@i]", value = "@stylePara.serviceType(i)" checked="checked">@stylePara.serviceType(i)
		    		}else{
						<input type = "checkbox" class="" name = "serviceType[@i]", value = "@stylePara.serviceType(i)">@stylePara.serviceType(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("styleAmount"),args = '_label ->Messages("hair.styleAmount")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.styleAmount.length-1){
		      		@if(style.styleAmount.contains(stylePara.styleAmount(i))){
		      			<input type = "checkbox" class="" name = "styleAmount[@i]", value = "@stylePara.styleAmount(i)" checked="checked">@stylePara.styleAmount(i)
		    		}else{
						<input type = "checkbox" class="" name = "styleAmount[@i]", value = "@stylePara.styleAmount(i)">@stylePara.styleAmount(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("styleQuality"),args = '_label ->Messages("hair.styleQuality")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.styleQuality.length-1){
		      		@if(style.styleQuality.contains(stylePara.styleQuality(i))){
		      			<input type = "checkbox" class="" name = "styleQuality[@i]", value = "@stylePara.styleQuality(i)" checked="checked">@stylePara.styleQuality(i)
		    		}else{
						<input type = "checkbox" class="" name = "styleQuality[@i]", value = "@stylePara.styleQuality(i)">@stylePara.styleQuality(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("styleDiameter"),args = '_label ->Messages("hair.styleDiameter")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.styleDiameter.length-1){
		      		@if(style.styleDiameter.contains(stylePara.styleDiameter(i))){
		      			<input type = "checkbox" class="" name = "styleDiameter[@i]", value = "@stylePara.styleDiameter(i)" checked="checked">@stylePara.styleDiameter(i)
		    		}else{
						<input type = "checkbox" class="" name = "styleDiameter[@i]", value = "@stylePara.styleDiameter(i)">@stylePara.styleDiameter(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("faceShape"),args = '_label ->Messages("hair.faceShape")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.faceShape.length-1){
		      		@if(style.faceShape.contains(stylePara.faceShape(i))){
		      			<input type = "checkbox" class="" name = "faceShape[@i]", value = "@stylePara.faceShape(i)" checked="checked">@stylePara.faceShape(i)
		    		}else{
						<input type = "checkbox" class="" name = "faceShape[@i]", value = "@stylePara.faceShape(i)">@stylePara.faceShape(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("consumerSocialStatus"),args = '_label ->Messages("hair.consumerSocialStatus")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.consumerSocialStatus.length-1){
		      		@if(style.consumerSocialStatus.contains(stylePara.consumerSocialStatus(i))){
		      			<input type = "checkbox" class="" name = "consumerSocialStatus[@i]", value = "@stylePara.consumerSocialStatus(i)" checked="checked">@stylePara.consumerSocialStatus(i)
		    		}else{
						<input type = "checkbox" class="" name = "consumerSocialStatus[@i]", value = "@stylePara.consumerSocialStatus(i)">@stylePara.consumerSocialStatus(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("consumerSex"),args = '_label ->Messages("hair.consumerSex")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.consumerSex.length-1){
		      		@if(style.consumerSex.equals(stylePara.consumerSex(i))){
		      			<input type = "radio" class="" name = "consumerSex", value = "@stylePara.consumerSex(i)" checked="checked">@stylePara.consumerSex(i)
		    		}else{
						<input type = "radio" class="" name = "consumerSex", value = "@stylePara.consumerSex(i)">@stylePara.consumerSex(i)
					}
		    	}
		    }
		    @input(field = styleAddForm("consumerAgeGroup"),args = '_label ->Messages("hair.consumerAgeGroup")){(id,name,value,args) =>
		    	@for(i <- 0 to stylePara.consumerAgeGroup.length-1){
		      		@if(style.consumerAgeGroup.contains(stylePara.consumerAgeGroup(i))){
		      			<input type = "checkbox" class="" name = "consumerAgeGroup[@i]", value = "@stylePara.consumerAgeGroup(i)" checked="checked">@stylePara.consumerAgeGroup(i)
		    		}else{
						<input type = "checkbox" class="" name = "consumerAgeGroup[@i]", value = "@stylePara.consumerAgeGroup(i)">@stylePara.consumerAgeGroup(i)
					}
		    	}
		    }
	    </div>
		<div>
			@Messages("hair.assessFromStylist")<input type = "text" class="" name = "description" value = "@style.description">
	    </div>
	    
	    <fieldset>
	    	<form action="fileUploadAction" enctype="multipart/form-data">
		    	<img src="loading.gif" id="loading" style="display: none;">
		    	<input type="file" id="file" name="photo" /><br />
		    	<input type="button" value="上传" onclick="return ajaxFileUpload();">
	            <legend>@Messages("user.optContactMethod")</legend>
        </form>
	    	<div id="optContactMethods">
                @repeat(styleAddForm("stylePic")) { stylePicOne =>
                    @stylePicOneGroup(stylePicOne)
                }
                @**
                 * Keep an hidden block that will be used as template for Javascript copy code
                 **@
                @stylePicOneGroup(
                    styleAddForm("stylePic[x]"),
                    className = "optContactMethod_template"
                )
                <div class="manage">
                    <a class="addOptContactMethod btn success">Add another stylePic</a>
                </div>
            </div>
        </fieldset>
        
        @*<input type="file" id="filePhoto" name="photo" style="width:50"  />*@
        <div id="target" style="aligin:center;width:156px;height:205px;">
        
        	@if(style!=null){
        		<h1>@style.id</h1>
	        	@style.stylePic.map{pic=>
	        		<h1>@pic.fileObjId</h1>
	        		<img src="@routes.Application.getPhoto(pic.fileObjId)"/>
	        	}
        	}
        </div>
        
	    <div align="center">
	        <input type = "reset" class = "buttons" value=@Messages("common.reset")>
		    <input type="submit" class = "buttons" value=@Messages("common.submit")>
        </div>
       }else{
       <div>
			@Messages("hair.styleName")<input type = "text" class="" name = "styleName" value = "">
		</div>
		<div>
			@*@input(field = styleAddForm("stylePic"),args = '_label ->"图片"){(id,name,value,args) =>*@
                <input type = "text" class="" name = "fileObjId" field = styleAddForm("stylePic.fileObjId") value = "">
                <input type = "text" class="" name = "picUse" field = styleAddForm("stylePic.picUse") value = "sshit">
                <input type = "number" class="" name = "showPriority" field = styleAddForm("stylePic.showPriority")value = "1">
                <input type = "text" class="" name = "description" field = styleAddForm("stylePic.description")value = "">
			@*}*@
		</div>
		<div>
			@Messages("hair.stylist")<input type = "text" class="" name = "stylistId" field = styleAddForm("stylistId") value = "53202c29d4d5e3cd47efffd3">	
		</div>
		<div align="left">	
		@input(field = styleAddForm("styleLength"),args = '_label ->Messages("hair.styleLength")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.styleLength.length-1){
                  <input type = "radio" class="" name = "styleLength", value = "@stylePara.styleLength(i)">@stylePara.styleLength(i)
            }
        }
        @input(field = styleAddForm("styleImpression"),args = '_label ->Messages("hair.impression")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.styleImpression.length-1){
                  <input type = "radio" class="" name = "styleImpression", value = "@stylePara.styleImpression(i)">@stylePara.styleImpression(i)
            }
        }
        @input(field = styleAddForm("styleColor"),args = '_label ->Messages("hair.color")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.styleColor.length-1){
                  <input type = "checkbox" class="" name = "styleColor[@i]", value = "@stylePara.styleColor(i)">@stylePara.styleColor(i)
            }
        }
        @input(field = styleAddForm("serviceType"),args = '_label ->Messages("hair.serviceType")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.serviceType.length-1){
                  <input type = "checkbox" class="" name = "serviceType[@i]", value = "@stylePara.serviceType(i)">@stylePara.serviceType(i)
            }
        }
        @input(field = styleAddForm("styleAmount"),args = '_label ->Messages("hair.styleAmount")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.styleAmount.length-1){
                  <input type = "checkbox" class="" name = "styleAmount[@i]", value = "@stylePara.styleAmount(i)">@stylePara.styleAmount(i)
            }
        }
        @input(field = styleAddForm("styleQuality"),args = '_label ->Messages("hair.styleQuality")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.styleQuality.length-1){
                  <input type = "checkbox" class="" name = "styleQuality[@i]", value = "@stylePara.styleQuality(i)">@stylePara.styleQuality(i)
            }
        }
        @input(field = styleAddForm("styleDiameter"),args = '_label ->Messages("hair.styleDiameter")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.styleDiameter.length-1){
                  <input type = "checkbox" class="" name = "styleDiameter[@i]", value = "@stylePara.styleDiameter(i)">@stylePara.styleDiameter(i)
            }
        }
        @input(field = styleAddForm("faceShape"),args = '_label ->Messages("hair.faceShape")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.faceShape.length-1){
                  <input type = "checkbox" class="" name = "faceShape[@i]" value = "@stylePara.faceShape(i)">@stylePara.faceShape(i)
            }
        }
        @input(field = styleAddForm("consumerSocialStatus"),args = '_label ->Messages("hair.consumerSocialStatus")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.consumerSocialStatus.length-1){
                  <input type = "checkbox" class="" name = "consumerSocialStatus[@i]" value = "@stylePara.consumerSocialStatus(i)">@stylePara.consumerSocialStatus(i)
            }
        }
        @input(field = styleAddForm("consumerSex"),args = '_label ->Messages("hair.consumerSex")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.consumerSex.length-1){
                  <input type = "radio" class="" name = "consumerSex" value = "@stylePara.consumerSex(i)">@stylePara.consumerSex(i)
            }
        }
        @input(field = styleAddForm("consumerAgeGroup"),args = '_label ->Messages("hair.consumerAgeGroup")){(id,name,value,args) =>
            @for(i <- 0 to stylePara.consumerAgeGroup.length-1){
                  <input type = "checkbox" class="" name = "consumerAgeGroup[@i]" value = "@stylePara.consumerAgeGroup(i)">@stylePara.consumerAgeGroup(i)
            }
        }
	    </div>
		<div>
			@Messages("hair.assessFromStylist")<input type = "text" class="" name = "description" value = "">
	    </div>
	    
	    <fieldset>
	    		<form action="fileUploadAction" enctype="multipart/form-data">
		    	<img src="loading.gif" id="loading" style="display: none;">
		    	<input type="file" id="file" name="photo" /><br />
		    	<input type="button" value="上传" onclick="return ajaxFileUpload();">
	            <legend>@Messages("user.optContactMethod")</legend>
        		</form>
                <legend>@Messages("user.optContactMethod")</legend>
                <div id="optContactMethods">
                    @repeat(styleAddForm("stylePic"), min = 0) { stylePicOne =>
                        @stylePicOneGroup(stylePicOne)
                    }
                    @**
                     * Keep an hidden block that will be used as template for Javascript copy code
                     **@
                    @stylePicOneGroup(
                        styleAddForm("stylePic[x]"),
                        className = "optContactMethod_template"
                    )
                    <div class="manage">
                        <a class="addOptContactMethod btn success">Add another stylePic</a>
                    </div>
                </div>
            </fieldset>
        
        @*<input type="file" id="filePhoto" name="photo" style="width:50"  /> *@
        <div id="target" style="aligin:center;width:156px;height:205px;">
        	@if(style!=null){
	        	@style.stylePic.map{pic=>
	        		<img src="@routes.Application.getPhoto(style.stylePic(0).fileObjId)"/>
	        	}
        	}
        </div>
        
	    <div align="center">
	        <input type = "reset" class = "buttons" value=@Messages("common.reset")>
		    <input type="submit" class = "buttons" value=@Messages("common.submit")>
        </div>
		} 

     }
     </body>
     
@stylePicOneGroup(field: Field, className: String = "optContactMethod") = {
    <div class="twipsies well @className">
        <a class="removeOptContactMethod btn danger pull-right">Remove this stylePic</a>
        @inputText(
            field("fileObjId"), 
            '_label -> "fileObjId",'placeholder -> new ObjectId, 'id -> "imageoffileobjid", 'class ->"imageoffileobjid"
        )
        @inputText(
            field("picUse"), 
            '_label -> "picUse"
        )
        @inputText(
            field("showPriority"), 
            '_label -> "showPriority"
        )
        @inputText(
            field("description"), 
            '_label -> "description"
        )
    </div>
    }    

	     

    
